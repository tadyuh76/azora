<Window xmlns="https://github.com/avaloniaui"
       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:AvaloniaAzora.Views.Admin"
        x:Class="AvaloniaAzora.Views.Admin.ClassEditWindow"
        Title="Azora - Edit Class"
        Width="600" Height="600"
        WindowStartupLocation="CenterScreen"
        Background="#F8F9FA"
        x:DataType="vm:ClassEditViewModel">

    <Border Background="White" CornerRadius="12" Margin="24">
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" OffsetX="0" OffsetY="4" 
                              Color="#000000" Opacity="0.1"/>
        </Border.Effect>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" BorderBrush="#E5E7EB" BorderThickness="0,0,0,1" Padding="24,20">
                <TextBlock Text="{Binding IsEditMode, Converter={x:Static BooleanToStringConverter.Instance}, ConverterParameter='Edit Class|Create New Class'}" 
                           FontSize="24" FontWeight="Bold" Foreground="#1F2937"/>
            </Border>

            <!-- Form Content -->
            <ScrollViewer Grid.Row="1" Padding="24">
                <StackPanel Spacing="20">
                    <!-- Class Name -->
                    <StackPanel>
                        <TextBlock Text="Class Name *" FontSize="14" FontWeight="SemiBold" 
                                   Foreground="#374151" Margin="0,0,0,8"/>
                        <TextBox Text="{Binding ClassName}" 
                                 Watermark="Enter class name (e.g., Mathematics 101)"
                                 FontSize="14" Padding="12,8" Height="40"/>
                    </StackPanel>

                    <!-- Description -->
                    <StackPanel>
                        <TextBlock Text="Description" FontSize="14" FontWeight="SemiBold" 
                                   Foreground="#374151" Margin="0,0,0,8"/>
                        <TextBox Text="{Binding Description}" 
                                 Watermark="Enter class description (optional)"
                                 FontSize="14" Padding="12,8" Height="80"
                                 TextWrapping="Wrap" AcceptsReturn="True"/>
                    </StackPanel>

                    <!-- Teacher Assignment -->
                    <StackPanel>
                        <TextBlock Text="Assigned Teacher" FontSize="14" FontWeight="SemiBold" 
                                   Foreground="#374151" Margin="0,0,0,8"/>
                        <ComboBox ItemsSource="{Binding AvailableTeachers}"
                                  SelectedValue="{Binding SelectedTeacherId}"
                                  DisplayMemberBinding="{Binding Name}"
                                  FontSize="14" Padding="12,8" Height="40">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Name}" FontSize="14"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                        <TextBlock Text="Select a teacher to manage this class" 
                                   FontSize="12" Foreground="#6B7280" Margin="0,4,0,0"/>
                    </StackPanel>

                    <!-- Active Status -->
                    <StackPanel>
                        <CheckBox IsChecked="{Binding IsActive}" 
                                  Content="Active Class" 
                                  FontSize="14" Foreground="#374151"/>
                        <TextBlock Text="Inactive classes are hidden from students and cannot be enrolled in" 
                                   FontSize="12" Foreground="#6B7280" Margin="24,4,0,0"/>
                    </StackPanel>

                    <!-- Error/Success Messages -->
                    <Border Background="#FEF2F2" BorderBrush="#FECACA" BorderThickness="1" 
                            CornerRadius="6" Padding="12,8" 
                            IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                        <TextBlock Text="{Binding ErrorMessage}" FontSize="14" 
                                   Foreground="#DC2626" TextWrapping="Wrap"/>
                    </Border>

                    <Border Background="#F0FDF4" BorderBrush="#BBF7D0" BorderThickness="1" 
                            CornerRadius="6" Padding="12,8" 
                            IsVisible="{Binding SuccessMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                        <TextBlock Text="{Binding SuccessMessage}" FontSize="14" 
                                   Foreground="#166534" TextWrapping="Wrap"/>
                    </Border>
                </StackPanel>
            </ScrollViewer>

            <!-- Footer -->
            <Border Grid.Row="2" BorderBrush="#E5E7EB" BorderThickness="0,1,0,0" Padding="24,20">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="12">
                    <Button Content="Cancel" 
                            Command="{Binding CancelCommand}"
                            Background="Transparent" Foreground="#6B7280"
                            BorderBrush="#D1D5DB" BorderThickness="1"
                            Padding="20,8" CornerRadius="6" FontSize="14"/>
                    <Button Content="{Binding IsEditMode, Converter={x:Static BooleanToStringConverter.Instance}, ConverterParameter='Update Class|Create Class'}" 
                            Command="{Binding SaveCommand}"
                            Background="#10B981" Foreground="White"
                            Padding="20,8" CornerRadius="6" FontSize="14"/>
                </StackPanel>
            </Border>

            <!-- Loading Overlay -->
            <Border Grid.Row="0" Grid.RowSpan="3" 
                    Background="#80000000" 
                    IsVisible="{Binding IsLoading}"
                    CornerRadius="12">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="âŸ³ Saving..." FontSize="18" Foreground="White" 
                               HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</Window>
